import{c as u,f as i,j as e,r as x,u as p,i as f,k as j,P as N,C as v}from"./index-CPFkeXTL.js";import{u as g}from"./deals-store-DHUgIiis.js";import{S as b}from"./shopping-bag-Ckpx03Rf.js";import{C}from"./circle-check-big-CZ38CVVF.js";import{D as y}from"./dollar-sign-c5L53ltU.js";import{T as h}from"./trending-up-Bb59yena.js";import{C as w}from"./calendar-CH4o-WYt.js";import{L as D}from"./loader-circle-Cke15f2O.js";const k=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],_=u("chevron-right",k);const P=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],S=u("plus",P);function $(){const a=g(s=>s.stats()),t=[{label:"Active Deals",value:a.activeDeals.toString(),icon:b,color:"text-blue-600"},{label:"Completed",value:a.completedDeals.toString(),icon:C,color:"text-green-600"},{label:"Invested",value:i(a.totalInvested),icon:y,color:"text-amber-600"},{label:"Total Profit",value:i(a.totalProfit),icon:h,color:a.totalProfit>=0?"text-green-600":"text-red-600"}];return e.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4",children:t.map(s=>e.jsxs("div",{className:"rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s.icon,{className:`h-4 w-4 ${s.color}`}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.label})]}),e.jsx("p",{className:"mt-1 text-xl font-semibold",children:s.value})]},s.label))})}const I=x.memo(function({deal:t}){const s=p(),c=t.itemCount?(t.soldCount||0)/t.itemCount*100:0,r=t.status==="completed",{estimatedProfit:n,roi:d}=x.useMemo(()=>{const l=f(t.estimated_value||0,t.total_cost||0),m=j(l,t.total_cost||0);return{estimatedProfit:l,roi:m}},[t.estimated_value,t.total_cost]);return e.jsxs("button",{onClick:()=>s(`/deals/${t.id}`),className:"w-full rounded-lg border p-4 text-left transition-colors hover:bg-accent/50",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:t.source||"Unknown Source"}),r&&e.jsx("span",{className:"rounded bg-green-100 px-2 py-0.5 text-xs font-medium text-green-700 dark:bg-green-900 dark:text-green-300",children:"Completed"})]}),e.jsxs("div",{className:"mt-1 flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"h-3.5 w-3.5"}),new Date(t.created_at).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(N,{className:"h-3.5 w-3.5"}),t.itemCount||0," items"]})]}),t.notes&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground line-clamp-1",children:t.notes})]}),e.jsx(_,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t.soldCount||0," / ",t.itemCount||0," sold"]}),e.jsxs("span",{children:[Math.round(c),"%"]})]}),e.jsx("div",{className:"mt-1 h-2 overflow-hidden rounded-full bg-muted",children:e.jsx("div",{className:`h-full rounded-full transition-all ${r?"bg-green-500":"bg-primary"}`,style:{width:`${c}%`}})})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 rounded-lg bg-muted/50 p-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cost"}),e.jsx("p",{className:"font-medium",children:i(t.total_cost)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:r?"Profit":"Est. Profit"}),e.jsx("p",{className:`font-medium ${(r?t.actual_profit||0:n)>=0?"text-green-600":"text-red-600"}`,children:i(r?t.actual_profit:n)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"ROI"}),e.jsxs("p",{className:"flex items-center gap-1 font-medium",children:[e.jsx(h,{className:"h-3.5 w-3.5"}),r&&t.actual_roi!==null?`${t.actual_roi.toFixed(0)}%`:`${d.toFixed(0)}%`]})]})]})]})});function O(){const a=p(),{loading:t,error:s,fetchDeals:c,filteredDeals:r,filters:n,setFilter:d}=g(),l=r();x.useEffect(()=>{c()},[c]);const m=[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Completed",value:"completed"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Deals"}),e.jsxs("button",{onClick:()=>a("/scan"),className:"flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground",children:[e.jsx(v,{className:"h-4 w-4"}),"New Deal"]})]}),e.jsx($,{}),e.jsx("div",{className:"flex gap-1 rounded-lg bg-muted p-1",children:m.map(o=>e.jsx("button",{onClick:()=>d("status",o.value),className:`flex-1 rounded-md px-4 py-2 text-sm font-medium transition-colors ${n.status===o.value?"bg-background shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:o.label},o.value))}),s&&e.jsx("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4 text-center",children:e.jsx("p",{className:"text-sm text-destructive",children:s})}),t&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(D,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),!t&&l.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",l.length," deal",l.length!==1?"s":""]}),l.map(o=>e.jsx(I,{deal:o},o.id))]}),!t&&l.length===0&&e.jsxs("div",{className:"rounded-lg border p-8 text-center",children:[e.jsx(S,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:n.status==="all"?"No deals yet.":`No ${n.status} deals.`}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Create a deal when you buy a lot to track your profit."}),e.jsx("button",{onClick:()=>a("/scan"),className:"mt-4 rounded-lg bg-primary px-6 py-2 text-sm font-medium text-primary-foreground",children:"Scan a Lot"})]})]})}export{O as DealsPage};
