import{c as k,j as e,P as I,f as o,X as h,r as d,u as g,C as p}from"./index-CPFkeXTL.js";import{u as x}from"./inventory-store-D7GLjq0X.js";import{T as j}from"./tag-Cx2YNOCy.js";import{C as _}from"./circle-check-big-CZ38CVVF.js";import{D as f}from"./dollar-sign-c5L53ltU.js";import{I as P,P as D}from"./constants-Cyhwx-4M.js";import{C as L}from"./confirm-modal-CNsLWem5.js";import{E as A}from"./ellipsis-vertical-D-UbPjlT.js";import{P as F}from"./pencil-xFFRPZLi.js";import{T}from"./triangle-alert-Bfna1AUJ.js";import{L as E}from"./loader-circle-Cke15f2O.js";const M=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],V=k("search",M);function O(){const a=x(s=>s.stats());return e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-3 text-center",children:[e.jsx(I,{className:"mx-auto h-5 w-5 text-blue-500"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:a.inStock}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"In Stock"})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 text-center",children:[e.jsx(j,{className:"mx-auto h-5 w-5 text-yellow-500"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:a.listed}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Listed"})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 text-center",children:[e.jsx(_,{className:"mx-auto h-5 w-5 text-green-500"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:a.sold}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Sold"})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 text-center",children:[e.jsx(f,{className:"mx-auto h-5 w-5 text-green-600"}),e.jsx("div",{className:"mt-1 text-lg font-bold",children:o(a.totalValue)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Value"})]})]})}function B(){const{filters:a,setFilter:s,resetFilters:n}=x(),l=a.status!=="all"||a.platform!=="all"||a.search!=="";return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(V,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx("input",{type:"text",value:a.search,onChange:t=>s("search",t.target.value),placeholder:"Search items...","aria-label":"Search inventory",className:"w-full rounded-lg border bg-background py-2 pl-10 pr-4"}),a.search&&e.jsx("button",{onClick:()=>s("search",""),"aria-label":"Clear search",className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:e.jsx(h,{className:"h-4 w-4"})})]}),e.jsxs("select",{value:a.status,onChange:t=>s("status",t.target.value),className:"rounded-lg border bg-background px-3 py-2",children:[e.jsx("option",{value:"all",children:"All Status"}),P.map(t=>e.jsx("option",{value:t,children:t==="in_stock"?"In Stock":t.charAt(0).toUpperCase()+t.slice(1)},t))]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("select",{value:a.platform,onChange:t=>s("platform",t.target.value),className:"rounded-lg border bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"All Platforms"}),D.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:`${a.sortBy}-${a.sortOrder}`,onChange:t=>{const[r,c]=t.target.value.split("-");s("sortBy",r),s("sortOrder",c)},className:"rounded-lg border bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"date-desc",children:"Newest First"}),e.jsx("option",{value:"date-asc",children:"Oldest First"}),e.jsx("option",{value:"name-asc",children:"Name A-Z"}),e.jsx("option",{value:"name-desc",children:"Name Z-A"}),e.jsx("option",{value:"value-desc",children:"Highest Value"}),e.jsx("option",{value:"value-asc",children:"Lowest Value"}),e.jsx("option",{value:"profit-desc",children:"Highest Profit"}),e.jsx("option",{value:"profit-asc",children:"Lowest Profit"})]}),l&&e.jsxs("button",{onClick:n,className:"flex items-center gap-1 rounded-lg border px-3 py-2 text-sm text-muted-foreground hover:bg-accent",children:[e.jsx(h,{className:"h-4 w-4"}),"Clear"]})]})]})}const $=d.memo(function({item:s}){const[n,l]=d.useState(!1),[t,r]=d.useState(!1),c=g(),{updateItem:v,deleteItem:N}=x(),{estimatedProfit:m,roi:b}=d.useMemo(()=>{const i=(s.estimated_value||0)-(s.purchase_cost||0),S=s.purchase_cost&&s.purchase_cost>0?i/s.purchase_cost*100:0;return{estimatedProfit:i,roi:S}},[s.estimated_value,s.purchase_cost]),y=()=>{switch(s.status){case"in_stock":return e.jsx("span",{className:"rounded bg-blue-100 px-2 py-0.5 text-xs text-blue-700",children:"In Stock"});case"listed":return e.jsx("span",{className:"rounded bg-yellow-100 px-2 py-0.5 text-xs text-yellow-700",children:"Listed"});case"sold":return e.jsx("span",{className:"rounded bg-green-100 px-2 py-0.5 text-xs text-green-700",children:"Sold"})}},u=async i=>{await v(s.id,{status:i}),l(!1)},w=()=>{l(!1),r(!0)},C=async()=>{await N(s.id),r(!1)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-medium",children:s.name}),y()]}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-sm text-muted-foreground",children:[s.platform&&e.jsx("span",{className:"rounded bg-secondary px-1.5 py-0.5 text-xs",children:s.platform}),s.condition&&e.jsx("span",{className:"uppercase",children:s.condition}),e.jsx("span",{children:s.weight})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>l(!n),"aria-label":"Item options",className:"rounded p-1 hover:bg-accent",children:e.jsx(A,{className:"h-5 w-5"})}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>l(!1)}),e.jsxs("div",{className:"absolute right-0 top-8 z-20 w-48 rounded-lg border bg-popover p-1 shadow-lg",children:[e.jsxs("button",{onClick:()=>c(`/inventory/${s.id}`),className:"flex w-full items-center gap-2 rounded px-3 py-2 text-sm hover:bg-accent",children:[e.jsx(F,{className:"h-4 w-4"}),"Edit Details"]}),s.status==="in_stock"&&e.jsxs("button",{onClick:()=>u("listed"),className:"flex w-full items-center gap-2 rounded px-3 py-2 text-sm hover:bg-accent",children:[e.jsx(j,{className:"h-4 w-4"}),"Mark Listed"]}),s.status!=="sold"&&e.jsxs("button",{onClick:()=>u("sold"),className:"flex w-full items-center gap-2 rounded px-3 py-2 text-sm hover:bg-accent",children:[e.jsx(f,{className:"h-4 w-4"}),"Record Sale"]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:w,className:"flex w-full items-center gap-2 rounded px-3 py-2 text-sm text-destructive hover:bg-destructive/10",children:[e.jsx(T,{className:"h-4 w-4"}),"Delete"]})]})]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex gap-4 text-muted-foreground",children:[e.jsxs("span",{children:["Cost: ",e.jsx("span",{className:"text-foreground",children:o(s.purchase_cost)})]}),e.jsxs("span",{children:["Value: ",e.jsx("span",{className:"text-foreground",children:o(s.estimated_value)})]})]}),s.status!=="sold"?e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:m>=0?"text-green-600":"text-red-600",children:o(m)}),e.jsxs("span",{className:"ml-1 text-xs text-muted-foreground",children:["(",b.toFixed(0),"%)"]})]}):e.jsxs("span",{className:"font-medium text-green-600",children:["+",o(s.actual_profit)]})]}),e.jsx(L,{isOpen:t,title:"Delete Item",message:`Are you sure you want to delete "${s.name}"? This cannot be undone.`,confirmLabel:"Delete",onConfirm:C,onCancel:()=>r(!1)})]})});function W(){const a=g(),{loading:s,error:n,fetchItems:l,filteredItems:t}=x(),r=t();return d.useEffect(()=>{l()},[l]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Inventory"}),e.jsxs("button",{onClick:()=>a("/scan"),className:"flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground",children:[e.jsx(p,{className:"h-4 w-4"}),"Scan Items"]})]}),e.jsx(O,{}),e.jsx(B,{}),n&&e.jsx("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4 text-center",children:e.jsx("p",{className:"text-sm text-destructive",children:n})}),s&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(E,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),!s&&r.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",r.length," item",r.length!==1?"s":""]}),r.map(c=>e.jsx($,{item:c},c.id))]}),!s&&r.length===0&&e.jsxs("div",{className:"rounded-lg border p-8 text-center",children:[e.jsx(p,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"No items in inventory yet."}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Scan some items to get started!"}),e.jsx("button",{onClick:()=>a("/scan"),className:"mt-4 rounded-lg bg-primary px-6 py-2 text-sm font-medium text-primary-foreground",children:"Start Scanning"})]})]})}export{W as InventoryPage};
