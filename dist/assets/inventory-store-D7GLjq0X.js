import{b as f,d as u,s as i}from"./index-CPFkeXTL.js";const c={status:"all",platform:"all",search:"",sortBy:"date",sortOrder:"desc"},g=f()(u((o,n)=>({items:[],loading:!1,error:null,filters:c,fetchItems:async()=>{o({loading:!0,error:null});const{data:r,error:e}=await i.from("items").select("*").order("created_at",{ascending:!1});if(e){o({error:e.message,loading:!1});return}o({items:r||[],loading:!1})},setFilter:(r,e)=>{o(s=>({filters:{...s.filters,[r]:e}}))},resetFilters:()=>{o({filters:c})},updateItem:async(r,e)=>{const s=e,{error:t}=await i.from("items").update(s).eq("id",r);if(t){o({error:t.message});return}o(a=>({items:a.items.map(l=>l.id===r?{...l,...e}:l)}))},deleteItem:async r=>{const{error:e}=await i.from("items").delete().eq("id",r);if(e){o({error:e.message});return}o(s=>({items:s.items.filter(t=>t.id!==r)}))},filteredItems:()=>{const{items:r,filters:e}=n();let s=[...r];if(e.status!=="all"&&(s=s.filter(t=>t.status===e.status)),e.platform!=="all"&&(s=s.filter(t=>t.platform===e.platform)),e.search){const t=e.search.toLowerCase();s=s.filter(a=>a.name.toLowerCase().includes(t)||a.platform?.toLowerCase().includes(t))}return s.sort((t,a)=>{let l=0;switch(e.sortBy){case"name":l=t.name.localeCompare(a.name);break;case"value":l=(t.estimated_value||0)-(a.estimated_value||0);break;case"profit":const d=(t.estimated_value||0)-(t.purchase_cost||0),m=(a.estimated_value||0)-(a.purchase_cost||0);l=d-m;break;default:l=new Date(t.created_at).getTime()-new Date(a.created_at).getTime()}return e.sortOrder==="desc"?-l:l}),s},stats:()=>{const{items:r}=n();return{inStock:r.filter(e=>e.status==="in_stock").length,listed:r.filter(e=>e.status==="listed").length,sold:r.filter(e=>e.status==="sold").length,totalValue:r.filter(e=>e.status!=="sold").reduce((e,s)=>e+(s.estimated_value||0),0)}}}),{name:"InventoryStore"}));export{g as u};
